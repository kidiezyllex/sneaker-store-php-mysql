<main class="home-main">
    <section class="hero-section">
        <div class="container-fluid px-0">
            <div id="heroCarousel" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-indicators">
                    <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="0" class="active" aria-label="Slide 1"></button>
                    <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
                    <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
                    <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="3" aria-label="Slide 4"></button>
                    <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="4" aria-label="Slide 5"></button>
                </div>
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <div class="hero-slide" style="background-image: url('https://images.pexels.com/photos/1070360/pexels-photo-1070360.jpeg');">
                            <div class="hero-overlay"></div>
                            <div class="hero-content text-center">
                                <span class="hero-eyebrow">SneakerShop Collection</span>
                                <h1 class="hero-title">Bộ Sưu Tập Mới 2025</h1>
                                <p class="hero-subtitle">Khám phá những mẫu giày thể thao mới nhất từ các thương hiệu hàng đầu.</p>
                                <div class="hero-actions">
                                    <a href="/products.php" class="btn btn-light btn-lg px-5" style="font-size: 16px;">Mua Ngay</a>
                                    <a href="/products.php?category=2" class="btn btn-outline-light btn-lg px-5" style="font-size: 16px;">Xem Lookbook</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <div class="hero-slide" style="background-image: url('https://images.pexels.com/photos/6748252/pexels-photo-6748252.jpeg');">
                            <div class="hero-overlay"></div>
                            <div class="hero-content text-center">
                                <span class="hero-eyebrow">Performance Running</span>
                                <h1 class="hero-title">Giày Chạy Bộ Chuyên Nghiệp</h1>
                                <p class="hero-subtitle">Công nghệ đệm tiên tiến cho mọi cự ly chạy.</p>
                                <div class="hero-actions">
                                    <a href="/products.php?category=1" class="btn btn-light btn-lg px-5" style="font-size: 16px;">Khám Phá</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <div class="hero-slide" style="background-image: url('https://images.pexels.com/photos/10195371/pexels-photo-10195371.jpeg');">
                            <div class="hero-overlay"></div>
                            <div class="hero-content text-center">
                                <span class="hero-eyebrow">Lifestyle Drops</span>
                                <h1 class="hero-title">Phong Cách Thời Trang</h1>
                                <p class="hero-subtitle">Sneaker lifestyle cho người yêu thời trang đường phố.</p>
                                <div class="hero-actions">
                                    <a href="/products.php?category=2" class="btn btn-light btn-lg px-5" style="font-size: 16px;">Xem Thêm</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <div class="hero-slide" style="background-image: url('https://images.pexels.com/photos/15249960/pexels-photo-15249960.jpeg');">
                            <div class="hero-overlay"></div>
                            <div class="hero-content text-center">
                                <span class="hero-eyebrow">Special Deals</span>
                                <h1 class="hero-title">Ưu Đãi Đặc Biệt</h1>
                                <p class="hero-subtitle">Giảm giá lên đến 30% cho sản phẩm chọn lọc.</p>
                                <div class="hero-actions">
                                    <a href="/products.php" class="btn btn-warning btn-lg px-5 text-dark fw-semibold" style="font-size: 16px;">Mua Ngay</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <div class="hero-slide" style="background-image: url('https://images.pexels.com/photos/6776614/pexels-photo-6776614.jpeg');">
                            <div class="hero-overlay"></div>
                            <div class="hero-content text-center">
                                <span class="hero-eyebrow">Elite Training</span>
                                <h1 class="hero-title">Thể Thao Chuyên Nghiệp</h1>
                                <p class="hero-subtitle">Giày bóng đá và bóng rổ cho vận động viên.</p>
                                <div class="hero-actions">
                                    <a href="/products.php?category=1" class="btn btn-light btn-lg px-5" style="font-size: 16px;">Tìm Hiểu</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon"></span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>
        </div>
    </section>

    <div class="container">
        <section class="home-section home-section--metrics pt-0">
            <div class="section-heading text-center">
                <h2 class="section-title">Tổng quan hiệu suất</h2>
                <p class="section-subtitle">Các chỉ số 30 ngày cho thấy mức độ tăng trưởng và sức hút hiện tại của SneakerShop.</p>
            </div>
            <div class="row row-cols-2 row-cols-md-4 g-3 g-lg-4">
                <div class="col">
                    <div class="stats-card stats-card--products">
                        <div class="stats-icon">
                            <i class="fas fa-cubes"></i>
                        </div>
                        <p class="stats-label">Sản phẩm đang bán</p>
                        <div class="stats-value"><?php echo number_format((int)($metrics['total_products'] ?? 0)); ?></div>
                    </div>
                </div>
                <div class="col">
                    <div class="stats-card stats-card--orders">
                        <div class="stats-icon">
                            <i class="fas fa-receipt"></i>
                        </div>
                        <p class="stats-label">Tổng đơn hàng</p>
                        <div class="stats-value"><?php echo number_format((int)($metrics['total_orders'] ?? 0)); ?></div>
                    </div>
                </div>
                <div class="col">
                    <div class="stats-card stats-card--customers">
                        <div class="stats-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <p class="stats-label">Khách hàng hoạt động</p>
                        <div class="stats-value"><?php echo number_format((int)($metrics['active_customers'] ?? 0)); ?></div>
                    </div>
                </div>
                <div class="col">
                    <div class="stats-card stats-card--revenue">
                        <div class="stats-icon">
                            <i class="fas fa-sack-dollar"></i>
                        </div>
                        <p class="stats-label">Doanh thu 30 ngày</p>
                        <div class="stats-value"><?php echo format_price((float)($metrics['revenue_30_days'] ?? 0)); ?></div>
                    </div>
                </div>
            </div>
        </section>

        <div class="section-divider"></div>

        <section class="home-section">
            <div class="section-heading text-center">
                <span class="section-eyebrow">Bộ sưu tập trong tuần</span>
                <h2 class="section-title">Sản phẩm nổi bật</h2>
                <p class="section-subtitle">Gợi ý những thiết kế đang được cộng đồng SneakerShop săn đón nhiều nhất.</p>
            </div>
            <div class="row g-4">
                <?php foreach ($featured_products as $product): ?>
                    <div class="col-12 col-sm-6 col-lg-3">
                        <div class="product-card h-100">
                            <div class="product-card__media">
                                <img src="<?php echo htmlspecialchars($product['img']); ?>" class="product-image" alt="<?php echo htmlspecialchars($product['name']); ?>">
                            </div>
                            <div class="product-card__body">
                                <h6 class="product-card__title"><?php echo htmlspecialchars($product['name']); ?></h6>
                                <p class="product-card__brand"><?php echo htmlspecialchars($product['brand_name']); ?></p>
                                <div class="product-card__rating">
                                    <div class="product-card__stars">
                                        <?php 
                                        $rating = rand(35, 50) / 10; 
                                        $fullStars = floor($rating);
                                        $hasHalfStar = ($rating - $fullStars) >= 0.5;
                                        for ($i = 0; $i < $fullStars; $i++): ?>
                                            <i class="fas fa-star"></i>
                                        <?php endfor; ?>
                                        <?php if ($hasHalfStar): ?>
                                            <i class="fas fa-star-half-alt"></i>
                                        <?php endif; ?>
                                        <?php 
                                        $emptyStars = 5 - $fullStars - ($hasHalfStar ? 1 : 0);
                                        for ($i = 0; $i < $emptyStars; $i++): ?>
                                            <i class="far fa-star"></i>
                                        <?php endfor; ?>
                                    </div>
                                    <span class="product-card__rating-text">(<?php echo number_format($rating, 1); ?>)</span>
                                </div>
                                <p class="product-card__price"><?php echo format_price($product['price']); ?></p>
                                <div class="product-card__actions">
                                    <a href="/product-detail.php?id=<?php echo $product['id']; ?>" class="btn btn-outline-primary btn-lg" style="font-size: 16px;">
                                        <i class="fas fa-eye"></i> Xem chi tiết
                                    </a>
                                    <?php $isFavorite = in_array($product['id'], $wishlist_product_ids ?? []); ?>
                                    <a href="#" class="product-card__favorite <?php echo $isFavorite ? 'active' : ''; ?>" data-product-id="<?php echo $product['id']; ?>" onclick="toggleFavorite(this, event); return false;" title="Thêm vào yêu thích">
                                        <i class="<?php echo $isFavorite ? 'fas fa-heart' : 'far fa-heart'; ?>"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                <?php endforeach; ?>
            </div>
            <div class="text-center mt-5">
                <a href="/products.php" class="btn btn-outline-primary btn-lg" style="font-size: 16px;">
                    <i class="fas fa-th"></i> Xem tất cả sản phẩm
                </a>
            </div>
        </section>

        <?php if (!empty($best_sellers)): ?>
            <div class="section-divider"></div>
            <section class="home-section home-section--muted">
                <div class="section-heading text-center">
                    <span class="section-eyebrow">Dựa trên doanh số</span>
                    <h2 class="section-title">Top bán chạy</h2>
                    <p class="section-subtitle">Những đôi sneaker được đặt mua nhiều nhất và luôn trong tình trạng cháy hàng.</p>
                </div>
                <div class="row g-4">
                    <?php foreach ($best_sellers as $product): ?>
                        <div class="col-12 col-sm-6 col-lg-3">
                            <div class="product-card h-100 product-card--highlight">
                                <div class="product-card__media">
                                    <img src="<?php echo htmlspecialchars($product['img']); ?>" class="product-image" alt="<?php echo htmlspecialchars($product['name']); ?>">
                                    <span class="product-card__badge">
                                        <i class="fas fa-fire"></i>
                                        <?php echo number_format((int)$product['total_sold']); ?> đôi đã bán
                                    </span>
                                </div>
                                <div class="product-card__body">
                                    <h6 class="product-card__title"><?php echo htmlspecialchars($product['name']); ?></h6>
                                    <div class="product-card__rating">
                                        <div class="product-card__stars">
                                            <?php 
                                            $rating = rand(40, 50) / 10;
                                            $fullStars = floor($rating);
                                            $hasHalfStar = ($rating - $fullStars) >= 0.5;
                                            for ($i = 0; $i < $fullStars; $i++): ?>
                                                <i class="fas fa-star"></i>
                                            <?php endfor; ?>
                                            <?php if ($hasHalfStar): ?>
                                                <i class="fas fa-star-half-alt"></i>
                                            <?php endif; ?>
                                            <?php 
                                            $emptyStars = 5 - $fullStars - ($hasHalfStar ? 1 : 0);
                                            for ($i = 0; $i < $emptyStars; $i++): ?>
                                                <i class="far fa-star"></i>
                                            <?php endfor; ?>
                                        </div>
                                        <span class="product-card__rating-text">(<?php echo number_format($rating, 1); ?>)</span>
                                    </div>
                                    <p class="product-card__price"><?php echo format_price($product['price']); ?></p>
                                    <div class="product-card__actions">
                                        <a href="/product-detail.php?id=<?php echo $product['id']; ?>" class="btn btn-dark" style="flex: 1;">
                                            <i class="fas fa-shopping-bag"></i> Thêm vào giỏ
                                        </a>
                                        <?php $isFavorite = in_array($product['id'], $wishlist_product_ids ?? []); ?>
                                        <a href="#" class="product-card__favorite <?php echo $isFavorite ? 'active' : ''; ?>" data-product-id="<?php echo $product['id']; ?>" onclick="toggleFavorite(this, event); return false;" title="Thêm vào yêu thích">
                                            <i class="<?php echo $isFavorite ? 'fas fa-heart' : 'far fa-heart'; ?>"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    <?php endforeach; ?>
                </div>
            </section>
        <?php endif; ?>

        <div class="section-divider"></div>

        <section class="home-section">
            <div class="section-heading text-center">
                <span class="section-eyebrow">Tùy chọn theo nhu cầu</span>
                <h2 class="section-title">Khám phá theo danh mục</h2>
                <p class="section-subtitle">Chọn nhanh danh mục phù hợp với phong cách và mục tiêu luyện tập của bạn.</p>
            </div>
            <div class="row g-4">
                <?php foreach ($top_categories as $category): ?>
                    <?php
                        $icon = $categoryIcons[$category['name']] ?? 'fa-shoe-prints';
                        $description = $category['description'] ?: 'Khám phá những phối màu độc đáo và công nghệ mới nhất.';
                    ?>
                    <div class="col-12 col-md-6 col-lg-3">
                        <div class="category-card">
                            <div class="category-card__header">
                                <div class="category-icon">
                                    <i class="fas <?php echo $icon; ?>"></i>
                                </div>
                                <div>
                                    <h5 class="category-card__title"><?php echo htmlspecialchars($category['name']); ?></h5>
                                    <p class="category-card__description"><?php echo htmlspecialchars($description); ?></p>
                                </div>
                            </div>
                            <div class="category-card__footer">
                                <span class="category-card__metric"><?php echo number_format((int)$category['product_count']); ?> sản phẩm</span>
                                <a
                                style="background-color: #fff; color: #2563EB;"
                                href="/products.php?category=<?php echo $category['id']; ?>" class="btn btn-outline-primary">
                                    <i class="fas fa-arrow-right"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                <?php endforeach; ?>
            </div>
        </section>

        <div class="section-divider"></div>

        <section class="home-section home-section--muted">
            <div class="section-heading text-center">
                <span class="section-eyebrow">Đối tác chiến lược</span>
                <h2 class="section-title">Thương hiệu nổi bật</h2>
                <p class="section-subtitle">Đối tác chính hãng từ Nike, Adidas, New Balance và nhiều thương hiệu thể thao danh tiếng.</p>
            </div>
            <div class="row g-4">
                <?php foreach ($top_brands as $brand): ?>
                    <div class="col-12 col-md-6 col-lg-4">
                        <div class="brand-card">
                            <div>
                                <span class="brand-metric">
                                    <i class="fas fa-boxes-stacked"></i>
                                    <?php echo number_format((int)$brand['product_count']); ?> mẫu
                                </span>
                                <h5 class="brand-card__title"><?php echo htmlspecialchars($brand['name']); ?></h5>
                                <p class="brand-card__description"><?php echo htmlspecialchars($brand['description'] ?: 'Khám phá các bộ sưu tập mới nhất và phiên bản giới hạn.'); ?></p>
                            </div>
                            <a href="/products.php?brand=<?php echo $brand['id']; ?>" class="btn btn-outline-dark">
                                <i class="fas fa-compass"></i> Xem bộ sưu tập
                            </a>
                        </div>
                    </div>
                <?php endforeach; ?>
            </div>
        </section>

        <div class="section-divider"></div>

        <section class="home-section">
            <div class="section-heading text-center">
                <span class="section-eyebrow">Cộng đồng SneakerShop</span>
                <h2 class="section-title">Trải nghiệm khách hàng</h2>
                <p class="section-subtitle">Nghe chia sẻ từ những thành viên đã đồng hành cùng SneakerShop trên mọi cung đường.</p>
            </div>
            <div class="row g-4">
                <?php foreach ($testimonials as $testimonial): ?>
                    <div class="col-12 col-md-4">
                        <div class="testimonial-card">
                            <div class="quote-icon">
                                <i class="fas fa-quote-left"></i>
                            </div>
                            <p class="testimonial-card__quote"><?php echo htmlspecialchars($testimonial['quote']); ?></p>
                            <div class="testimonial-info">
                                <img src="<?php echo htmlspecialchars($testimonial['avatar']); ?>" alt="<?php echo htmlspecialchars($testimonial['name']); ?>" class="testimonial-avatar">
                                <div>
                                    <div class="testimonial-name"><?php echo htmlspecialchars($testimonial['name']); ?></div>
                                    <div class="testimonial-role"><?php echo htmlspecialchars($testimonial['role']); ?></div>
                                </div>
                            </div>
                        </div>
                    </div>
                <?php endforeach; ?>
            </div>
        </section>

        <div class="section-divider"></div>

        <section class="home-section home-section--muted">
            <div class="section-heading text-center">
                <span class="section-eyebrow">Góc kiến thức</span>
                <h2 class="section-title">Cẩm nang sneaker</h2>
                <p class="section-subtitle">Bài viết độc quyền cập nhật xu hướng, mẹo bảo quản và kiến thức luyện tập.</p>
            </div>
            <div class="row g-4">
                <?php foreach ($blog_posts as $post): ?>
                    <div class="col-12 col-md-4">
                        <div class="blog-card">
                            <div class="blog-card__media">
                                <img src="<?php echo htmlspecialchars($post['image']); ?>" alt="<?php echo htmlspecialchars($post['title']); ?>">
                                <span class="blog-card__category"><?php echo htmlspecialchars($post['category']); ?></span>
                            </div>
                            <div class="blog-card__content">
                                <h5 class="blog-card__title"><?php echo htmlspecialchars($post['title']); ?></h5>
                                <p class="blog-card__excerpt"><?php echo htmlspecialchars($post['excerpt']); ?></p>
                                <a href="<?php echo htmlspecialchars($post['url']); ?>" class="btn btn-link px-0">
                                    <i class="fas fa-book-open"></i> Đọc ngay
                                </a>
                            </div>
                        </div>
                    </div>
                <?php endforeach; ?>
            </div>
        </section>

        <div class="section-divider"></div>

        <section class="home-section">
            <div class="cta-banner">
                <div class="row align-items-center gy-4">
                    <div class="col-lg-7">
                        <span class="section-eyebrow text-white">Thành viên SneakerClub</span>
                        <h3 class="cta-banner__title">Gia nhập SneakerClub</h3>
                        <p class="cta-banner__lead">Nhận ưu đãi 10% cho đơn hàng đầu tiên, quyền truy cập sớm các bộ sưu tập giới hạn và chương trình tích điểm dành riêng cho thành viên.</p>
                        <div class="cta-actions">
                            <a href="/register.php" class="btn btn-light">
                                <i class="fas fa-user-plus"></i> Đăng ký ngay
                            </a>
                            <a href="/products.php" class="btn btn-outline-light">
                                <i class="fas fa-store"></i> Khám phá bộ sưu tập
                            </a>
                        </div>
                    </div>
                    <div class="col-lg-5 text-lg-end text-center">
                        <img src="https://images.pexels.com/photos/8939565/pexels-photo-8939565.jpeg?auto=compress&cs=tinysrgb&w=400" alt="Sneaker Club" class="img-fluid rounded-4 shadow-sm">
                    </div>
                </div>
            </div>
        </section>

        <div class="section-divider"></div>

        <section class="home-section">
            <div class="section-heading text-center">
                <span class="section-eyebrow">Cam kết dịch vụ</span>
                <h2 class="section-title">Lý do chọn SneakerShop</h2>
            </div>
            <div class="row g-4">
                <div class="col-12 col-md-4">
                    <div class="service-pill h-100 text-center">
                        <i class="fas fa-shipping-fast fa-2x mb-3"></i>
                        <h5>Giao hàng nhanh</h5>
                        <p>Đặt trước 12h trưa giao trong ngày tại Hà Nội &amp; TP.HCM, toàn quốc chỉ 2-3 ngày.</p>
                    </div>
                </div>
                <div class="col-12 col-md-4">
                    <div class="service-pill h-100 text-center">
                        <i class="fas fa-shield-alt fa-2x mb-3"></i>
                        <h5>Hàng chính hãng</h5>
                        <p>Cam kết 100% chính hãng, hoàn tiền gấp đôi nếu phát hiện hàng giả.</p>
                    </div>
                </div>
                <div class="col-12 col-md-4">
                    <div class="service-pill h-100 text-center">
                        <i class="fas fa-headset fa-2x mb-3"></i>
                        <h5>Chăm sóc 24/7</h5>
                        <p>Đội ngũ stylist và chuyên gia chạy bộ sẵn sàng tư vấn mọi lúc.</p>
                    </div>
                </div>
            </div>
        </section>
    </div>
</main>